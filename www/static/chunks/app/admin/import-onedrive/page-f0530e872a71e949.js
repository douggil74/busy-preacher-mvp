(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3029],{6132:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(71847).A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},20063:(e,s,t)=>{"use strict";var r=t(47260);t.o(r,"useParams")&&t.d(s,{useParams:function(){return r.useParams}}),t.o(r,"useRouter")&&t.d(s,{useRouter:function(){return r.useRouter}}),t.o(r,"useSearchParams")&&t.d(s,{useSearchParams:function(){return r.useSearchParams}})},27738:(e,s,t)=>{"use strict";async function r(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t={...s.headers,...function(){let e="b6d6eb3a47a4f760d86ac26ef70d73d49dbf552f3270e8356f18d8db52874da2";return e||console.error("[Admin API] NEXT_PUBLIC_ADMIN_API_SECRET not configured"),{Authorization:"Bearer ".concat(e)}}()};return fetch(e,{...s,headers:t})}async function a(e,s){return r(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})}async function l(e,s){return r(e,{method:"POST",body:s})}async function n(e){return r(e,{method:"GET"})}t.d(s,{Cw:()=>n,KQ:()=>l,eM:()=>a})},32320:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(71847).A)("cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]])},35299:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(71847).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},35626:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(71847).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},42529:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(71847).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},43809:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>u});var r=t(95155),a=t(12115),l=t(35626),n=t(32320),o=t(42529),i=t(6132),c=t(35299),d=t(20063),m=t(88371),x=t(27738),h=t(95704);function u(){let e=(0,d.useRouter)(),[s,t]=(0,a.useState)(""),[u,p]=(0,a.useState)("root:/Sermons"),[b,f]=(0,a.useState)(!1),[g,j]=(0,a.useState)(null),N=async()=>{if(!s)return void alert("Please authorize OneDrive access first");f(!0),j(null);try{let e=await (0,x.eM)("/api/sermons/import-onedrive",{accessToken:s,folderId:u}),t=await e.json();j(t)}catch(e){j({success:!1,message:e instanceof Error?e.message:"Import failed"})}finally{f(!1)}};return(0,a.useEffect)(()=>{{let e=new URLSearchParams(window.location.hash.substring(1)).get("access_token");e&&(t(e),window.history.replaceState({},document.title,window.location.pathname))}},[]),(0,r.jsxs)(m.A,{children:[(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-950 via-slate-900 to-slate-950 p-4",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,r.jsxs)("div",{className:"mb-8 flex items-center gap-4",children:[(0,r.jsx)("button",{onClick:()=>e.push("/admin/sermons"),className:"p-2 hover:bg-slate-800 rounded-lg transition-colors",children:(0,r.jsx)(l.A,{className:"w-5 h-5 text-slate-400"})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h1",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[(0,r.jsx)(n.A,{className:"w-8 h-8 text-blue-400"}),"Import from OneDrive"]}),(0,r.jsx)("p",{className:"text-slate-300 mt-1",children:"Bulk import your sermon archive"})]})]}),g&&(0,r.jsx)("div",{className:"mb-6 p-4 rounded-lg border ".concat(g.success?"bg-green-500/10 border-green-500":"bg-red-500/10 border-red-500"),children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[g.success?(0,r.jsx)(o.A,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}):(0,r.jsx)(i.A,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:"font-medium ".concat(g.success?"text-green-500":"text-red-500"),children:g.message}),g.success&&void 0!==g.imported&&(0,r.jsxs)("p",{className:"text-slate-300 mt-2",children:[(0,r.jsx)("strong",{children:g.imported})," sermons imported,",(0,r.jsxs)("strong",{children:[" ",g.skipped]})," skipped (out of ",(0,r.jsx)("strong",{children:g.total})," files)"]}),g.errors&&g.errors.length>0&&(0,r.jsxs)("details",{className:"mt-3",children:[(0,r.jsxs)("summary",{className:"cursor-pointer text-sm text-slate-200 hover:text-white",children:["Show errors (",g.errors.length,")"]}),(0,r.jsx)("ul",{className:"mt-2 space-y-1 text-sm text-slate-300",children:g.errors.map((e,s)=>(0,r.jsxs)("li",{children:["• ",e]},s))})]})]})]})}),(0,r.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-6 space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-white mb-3",children:"Step 1: Authorize OneDrive Access"}),s?(0,r.jsxs)("div",{className:"p-3 bg-green-500/10 border border-green-500 rounded-lg flex items-center gap-2",children:[(0,r.jsx)(o.A,{className:"w-5 h-5 text-green-500"}),(0,r.jsx)("span",{className:"text-green-500 font-medium",children:"Connected to OneDrive"})]}):(0,r.jsxs)("button",{onClick:()=>{let e=h.env.NEXT_PUBLIC_ONEDRIVE_CLIENT_ID||"YOUR_CLIENT_ID",s=encodeURIComponent(window.location.origin+"/admin/import-onedrive"),t=encodeURIComponent("Files.Read.All offline_access"),r="https://login.microsoftonline.com/common/oauth2/v2.0/authorize?client_id=".concat(e,"&response_type=token&redirect_uri=").concat(s,"&scope=").concat(t);window.location.href=r},className:"px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors flex items-center gap-2",children:[(0,r.jsx)(n.A,{className:"w-5 h-5"}),"Sign in with Microsoft"]})]}),s&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-white mb-3",children:"Step 2: Specify Folder Path"}),(0,r.jsx)("p",{className:"text-sm text-slate-200 mb-3",children:"Enter the path to your sermon files folder in OneDrive"}),(0,r.jsx)("input",{type:"text",value:u,onChange:e=>p(e.target.value),className:"w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"root:/Sermons"}),(0,r.jsxs)("p",{className:"text-xs text-slate-300 mt-2",children:["Examples: ",(0,r.jsx)("code",{className:"bg-slate-700 px-1 rounded text-slate-200",children:"root:/Sermons"})," or ",(0,r.jsx)("code",{className:"bg-slate-700 px-1 rounded text-slate-200",children:"root:/Documents/Sermons"})]})]}),s&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-white mb-3",children:"Step 3: Import Sermons"}),(0,r.jsx)("button",{onClick:N,disabled:b||!s,className:"w-full px-6 py-3 bg-gradient-to-br from-amber-500 to-amber-600 hover:from-amber-600 hover:to-amber-700 text-white rounded-lg font-medium transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:b?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.A,{className:"w-5 h-5 animate-spin"}),"Importing Sermons..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.A,{className:"w-5 h-5"}),"Start Import"]})})]}),(0,r.jsxs)("div",{className:"p-4 bg-blue-500/10 border border-blue-500 rounded-lg",children:[(0,r.jsx)("h3",{className:"font-semibold text-blue-400 mb-2",children:"What This Does:"}),(0,r.jsxs)("ul",{className:"space-y-1 text-sm text-slate-300",children:[(0,r.jsx)("li",{children:"• Reads all .txt, .doc, .docx, and .pdf files from your OneDrive folder"}),(0,r.jsx)("li",{children:"• Extracts sermon title, date, and content"}),(0,r.jsx)("li",{children:"• Generates AI embeddings for semantic search"}),(0,r.jsx)("li",{children:"• Stores everything in Supabase for Pastoral Counseling"}),(0,r.jsx)("li",{children:"• Skips duplicates automatically"})]})]}),(0,r.jsxs)("div",{className:"p-4 bg-slate-900 border border-slate-700 rounded-lg",children:[(0,r.jsx)("h3",{className:"font-semibold text-white mb-2",children:"Recommended File Naming:"}),(0,r.jsx)("code",{className:"text-sm text-green-400 block mb-2",children:"YYYY-MM-DD Sermon Title.txt"}),(0,r.jsxs)("p",{className:"text-xs text-slate-200",children:["Examples:",(0,r.jsx)("br",{}),"• ",(0,r.jsx)("span",{className:"text-slate-100",children:"2020-03-15 Walking by Faith.txt"}),(0,r.jsx)("br",{}),"• ",(0,r.jsx)("span",{className:"text-slate-100",children:"2021-07-04 God's Love Never Fails.txt"})]})]})]})]})}),");"]})}},99632:(e,s,t)=>{Promise.resolve().then(t.bind(t,43809))}},e=>{e.O(0,[4077,8371,8441,1255,7358],()=>e(e.s=99632)),_N_E=e.O()}]);